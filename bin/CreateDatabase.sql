CREATE DATABASE IF NOT EXISTS DUTY_ROSTER;
USE DUTY_ROSTER;

CREATE TABLE IF NOT EXISTS Member (
	ID int NOT NULL AUTO_INCREMENT,
	NAME varchar(30) NOT NULL,
	ADDRESS varchar(50),
	SUBURB varchar(30),
	STATE varchar(20),
	POSTCODE varchar(10),
	SPOUSE_ID int,
	HOME_PHONE varchar(20),
	MOBILE_PHONE varchar(20),
	BALANCE decimal(5, 2),
	PRIMARY KEY (ID)
);

CREATE TABLE IF NOT EXISTS Book (
	ID int NOT NULL AUTO_INCREMENT,
	NAME varchar(100) NOT NULL,
	QUANTITY_ON_HAND int,
	PRICE decimal(4, 2),
	PRIMARY KEY (ID)
);

CREATE TABLE BOOK_PURCHASE (
	ID int NOT NULL AUTO_INCREMENT,
	MEMBER_ID INT,
	BOOK_ID INT,
	PRIMARY KEY (ID),
	FOREIGN KEY (MEMBER_ID) REFERENCES MEMBER(ID),
	FOREIGN KEY (BOOK_ID) REFERENCES BOOK(ID)
);

CREATE TABLE IF NOT EXISTS DUTY (
	ID INT NOT NULL AUTO_INCREMENT,
	NAME VARCHAR(255),
	DESCRIPTION VARCHAR(1024),
	PRIMARY KEY (ID)
);

CREATE TABLE IF NOT EXISTS CAPABILITY (
	ID INT NOT NULL AUTO_INCREMENT,
	MEMBER_ID INT,
	DUTY_ID INT,
	PRIMARY KEY (ID),
	FOREIGN KEY (MEMBER_ID) REFERENCES MEMBER (ID) ON DELETE CASCADE,
	FOREIGN KEY (DUTY_ID) REFERENCES DUTY (ID) ON DELETE CASCADE 
);

CREATE TABLE IF NOT EXISTS EVENT (
	ID INT NOT NULL AUTO_INCREMENT,
	NAME VARCHAR(255),
	DAY_OF_WEEK VARCHAR(1024),
	TIME_OF_DAY TIME,
	PRIMARY KEY (ID)
);

CREATE TABLE EVENT_DUTY (
	ID INT NOT NULL AUTO_INCREMENT,
	EVENT_ID INT,
	DUTY_ID INT,
	NUMBER_OF_PEOPLE INT,
	PRIMARY KEY (ID),
	FOREIGN KEY (EVENT_ID) REFERENCES EVENT (ID) ON DELETE CASCADE,
	FOREIGN KEY (DUTY_ID) REFERENCES DUTY (ID) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS AVAILABILITY (
	ID INT NOT NULL AUTO_INCREMENT,
	CAPABILITY_ID INT,
	EVENT_DUTY_ID INT,
	PRIMARY KEY (ID),
	FOREIGN KEY (CAPABILITY_ID) REFERENCES CAPABILITY (ID) ON DELETE CASCADE,
	FOREIGN KEY (EVENT_DUTY_ID) REFERENCES EVENT_DUTY (ID) ON DELETE CASCADE
);

INSERT INTO MEMBER (ID, NAME, ADDRESS, SUBURB, STATE, POSTCODE, SPOUSE_ID, HOME_PHONE, MOBILE_PHONE, BALANCE) VALUES (1, "Bob Smith", "21 Test Way", "TestVille", "VIC", "3689", 2, "03 5776 3454", "0436 655 354", 100);
INSERT INTO MEMBER (ID, NAME, ADDRESS, SUBURB, STATE, POSTCODE, SPOUSE_ID, HOME_PHONE, MOBILE_PHONE, BALANCE) VALUES (2, "Mary Smith", "21 Test Way", "TestVille", "VIC", "3689", 1, "03 5776 3454", "0454 646 756", 200);
INSERT INTO MEMBER (ID, NAME, ADDRESS, SUBURB, STATE, POSTCODE, SPOUSE_ID, HOME_PHONE, MOBILE_PHONE, BALANCE) VALUES (3, "Lauren Jones", "34 Handy Place", "Horrortown", "VIC", "3267", null,"03 9765 3456", "0426 456 467", 0);

INSERT INTO BOOK (ID, NAME, QUANTITY_ON_HAND, PRICE) VALUES (1, "King James Bible", 5, 35.45);
INSERT INTO BOOK (ID, NAME, QUANTITY_ON_HAND, PRICE) VALUES (2, "Christadelphian Hymn Book (Small)", 1, 19.00);
INSERT INTO BOOK (ID, NAME, QUANTITY_ON_HAND, PRICE) VALUES (3, "A Time to Hear", 9, 24.95);
INSERT INTO BOOK (ID, NAME, QUANTITY_ON_HAND, PRICE) VALUES (4, "ESV Bible - Hardcover", 0, 97.83);

INSERT INTO DUTY (ID, NAME, DESCRIPTION) VALUES (1, "Chairman", "The person who runs the meeting");
INSERT INTO DUTY (ID, NAME, DESCRIPTION) VALUES (2, "Reader", "The person allocated to read the chosen portion of scripture");
INSERT INTO DUTY (ID, NAME, DESCRIPTION) VALUES (3, "Pianist", "The person allocated to play the piano to accompany the congregation");
INSERT INTO DUTY (ID, NAME, DESCRIPTION) VALUES (4, "Steward", "The person who takes the emblems around to the congregation");
INSERT INTO DUTY (ID, NAME, DESCRIPTION) VALUES (5, "Exhorter", "The person who gives the word of exhortation to encourage the congregation");
INSERT INTO DUTY (ID, NAME, DESCRIPTION) VALUES (6, "Speaker", "The person who gives the talk");
INSERT INTO DUTY (ID, NAME, DESCRIPTION) VALUES (7, "Supper Provider", "The person who provides refreshments following the event");

INSERT INTO CAPABILITY (ID, MEMBER_ID, DUTY_ID) VALUES (1, 1, 1);
INSERT INTO CAPABILITY (ID, MEMBER_ID, DUTY_ID) VALUES (2, 1, 2);
INSERT INTO CAPABILITY (ID, MEMBER_ID, DUTY_ID) VALUES (3, 3, 3);

INSERT INTO EVENT (ID, NAME, DAY_OF_WEEK, TIME_OF_DAY) VALUES (1, "Memorial Meeting", "Sunday", "10:50:00");
INSERT INTO EVENT (ID, NAME, DAY_OF_WEEK, TIME_OF_DAY) VALUES (2, "Bible Class", "Sunday", "18:00:00");
INSERT INTO EVENT (ID, NAME, DAY_OF_WEEK, TIME_OF_DAY) VALUES (3, "Wednesday Night Class", "Wednesday", "19:30:00");

INSERT INTO EVENT_DUTY (ID, EVENT_ID, DUTY_ID, NUMBER_OF_PEOPLE) VALUES (1, 1, 1, 1);
INSERT INTO EVENT_DUTY (ID, EVENT_ID, DUTY_ID, NUMBER_OF_PEOPLE) VALUES (2, 1, 2, 1);
INSERT INTO EVENT_DUTY (ID, EVENT_ID, DUTY_ID, NUMBER_OF_PEOPLE) VALUES (3, 1, 3, 1);
INSERT INTO EVENT_DUTY (ID, EVENT_ID, DUTY_ID, NUMBER_OF_PEOPLE) VALUES (4, 1, 4, 2);